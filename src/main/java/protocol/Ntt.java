package protocol;

import java.math.BigInteger;
import java.util.*;

import org.apache.commons.math3.primes.Primes;

/**
 * Represents all math operations with objects of class Polynomial. For efficiency, everything is done in NTT domain.
 * <p>
 * When an instance is constructed, arrays zetas and zetas inverted are computed.
 * Otherwise, provides just utility functions add, inverse, subtracts, multiply.
 * NTT stuff heavily inspired by https://electricdusk.com/ntt.html
 * </p>
 */
class Ntt {

    private final BigInteger n;
    private final BigInteger q;

    private final List<BigInteger> zetas = new ArrayList<>();
    private final List<BigInteger> zetasInverted = new ArrayList<>();

    private final List<List<ModuloPoly>> nttTree = new ArrayList<>();

    /**
     * Computes Euler's totient function using prime factors.
     * !!! does NOT work if n does NOT fit into int !!!
     * @return euler's totient function of n.
     */
    public static BigInteger eulerPhi(BigInteger n) {
        int nInt = n.intValue();
        List<Integer> factors = Primes.primeFactors(nInt);

        // Convert to a set of unique prime factors
        Set<Integer> uniquePrimes = new HashSet<>(factors);

        BigInteger result = n;
        for (int p : uniquePrimes) {
            // Use Euler's totient formula
            result = result.subtract(result.divide(BigInteger.valueOf(p)));
        }
        return result;
    }

    /**
     * Computes multiplicative order of a mod q.
     * <p>
     * Tries all dividers of Euler Phi from the smallest to the highest.
     * SOURCE: ChatGPT
     * </p>
     * @param a
     * @param q
     * @return multiplicative order of a modulo q.
     */
    private static BigInteger order(BigInteger a, BigInteger q) {
        BigInteger phi = eulerPhi(q);
        for (BigInteger d = BigInteger.ONE; d.compareTo(phi) <= 0; d = d.add(BigInteger.ONE)) {
            if (phi.mod(d).equals(BigInteger.ZERO)) {
                if (a.modPow(d, q).equals(BigInteger.ONE)) {
                    return d;
                }
            }
        }
        return phi;
    }

    /**
     * Computes zeta from NTT tree, so primitive (2*n)-th root of unity.
     * @return zeta from NTT tree.
     */
    private BigInteger computeZeta() {
        List<ModuloPoly> lstLayer = nttTree.getLast();
        BigInteger nRoot = lstLayer.getFirst().getIndexZeta();
        // Collect all n-th roots of unity modulo q.
        // So find all x such that x^n is congruent to 1 modulo q.
        // SOURCE: ChatGPT
        List<BigInteger> nthRoots = new ArrayList<>();
        for (BigInteger x = BigInteger.ZERO; x.compareTo(q) < 0; x = x.add(BigInteger.ONE)) {  // !!! TAKES A LOT OF TIME !!!
            if (x.modPow(nRoot, q).equals(BigInteger.ONE)) {
                nthRoots.add(x);
            }
        }
        // Filter primitive roots from n-th roots of unity modulo q.
        // So find all n-th roots of unity where n is the smallest positive power n s.t. x^n is congruent to 1 modulo q.
        // In other words find all n-th roots of unity which have order of a modulo n equal to n.
        // SOURCE: ChatGPT
        List<BigInteger> possibleZetas = new ArrayList<>();
        for (BigInteger root : nthRoots) {
            if (order(root, q).compareTo(nRoot) == 0) {
                possibleZetas.add(root);
            }
        }
        System.out.println(possibleZetas);  // REMOVE
        return possibleZetas.getFirst();
    }
    /**
     * Computes tree of modulo polynomials. Everything from layer X^(n//2) to X^1.
     */
    private void computeNttTree() {
        BigInteger powerX = n.divide(BigInteger.TWO);
        BigInteger indexZeta = BigInteger.valueOf(4);
        List<ModuloPoly> fstLayer = new ArrayList<>();
        fstLayer.add(new ModuloPoly(powerX, true, BigInteger.ONE, indexZeta));
        fstLayer.add(new ModuloPoly(powerX, false, BigInteger.ONE, indexZeta));
        nttTree.add(fstLayer);

        while (powerX.compareTo(BigInteger.ONE) > 0) {

            powerX = powerX.divide(BigInteger.TWO);
            indexZeta = indexZeta.multiply(BigInteger.TWO);

            List<ModuloPoly> newLayer = new ArrayList<>();
            List<ModuloPoly> lstLayer = nttTree.getLast();
            for (ModuloPoly poly : lstLayer) {
                BigInteger powerZeta = poly.getPowerZeta();
                if (poly.getPlus()) {
                    powerZeta = powerZeta.add(poly.getIndexZeta().divide(BigInteger.TWO));
                }
                ModuloPoly plusPoly = new ModuloPoly(powerX, true, powerZeta, indexZeta);
                ModuloPoly minusPoly = new ModuloPoly(powerX, false, powerZeta, indexZeta);
                newLayer.add(plusPoly);
                newLayer.add(minusPoly);
            }
            nttTree.add(newLayer);
        }
    }

    private void generateArrays(BigInteger zeta) {
        for (List<ModuloPoly> layer: nttTree) {
            for (BigInteger i = BigInteger.ZERO; i.compareTo(BigInteger.valueOf(layer.size())) < 0; i = i.add(BigInteger.ONE)) {
                if (i.mod(BigInteger.TWO).compareTo(BigInteger.ONE) == 0) {
                    continue;
                }
                ModuloPoly poly = layer.get(i.intValue());  // !!! conversion from BigInteger to Int !!!
                BigInteger power = poly.getPowerZeta();
                BigInteger index = poly.getIndexZeta();
                BigInteger nRoot = nttTree.getLast().getFirst().getIndexZeta();  // look at the first zeta index in the last layer
                BigInteger z = zeta.modPow(nRoot.divide(index), q).modPow(power, q);
                BigInteger zInverted = z.modPow(BigInteger.valueOf(-1), q);
                zetas.add(z);
                zetasInverted.add(zInverted);
            }
        }
    }

    private void computeZetaArrays() {
        computeNttTree();
        BigInteger zeta = computeZeta();
        generateArrays(zeta);
    }

    Ntt(BigInteger n, BigInteger q) {
        this.n = n;
        this.q = q;
        //computeZetaArrays();  // WORKS perfectly, HOWEVER it is too slow (+- 22 mins for 30bits Q), so for now I will use following 4 rows.
        List<Integer> zetasInts = new ArrayList<>(Arrays.asList(103343005, 1064867428, 542201251, 399454196, 490275507, 941528630, 35327516, 892202168, 982074649, 928017475, 858613824, 746225331, 877379164, 28361968, 744493664, 9981797, 667380155, 434824480, 364435395, 1043494371, 111821409, 563456335, 614583843, 809462365, 668491131, 623659116, 446427570, 701540122, 101449280, 21775229, 680182259, 93014439, 584409549, 65488756, 410617089, 254756344, 565012584, 9269587, 528123121, 647346466, 789265342, 187972803, 31847132, 343141126, 362977804, 553162505, 118945294, 254450336, 713364045, 1057050099, 355564088, 187302535, 191226266, 371916275, 469114019, 36458697, 278513684, 862881203, 78237688, 511319131, 292488577, 695148201, 71006940, 534631925, 847569631, 250036610, 464115689, 772585339, 592202860, 676881793, 133081928, 831493811, 490293170, 256511161, 792917234, 1040560942, 964680516, 401563452, 127026363, 46126713, 343142096, 884704167, 319210467, 1057375656, 243567524, 563687194, 1037702773, 25315394, 927488363, 1001670944, 1056911158, 333758607, 769483192, 1035264792, 964375330, 344615819, 920257547, 644269923, 1069897201, 929739406, 987910858, 565702177, 227979238, 100007835, 74888457, 310187758, 1011322011, 815645372, 676135769, 284667882, 420661573, 1052021363, 649827496, 430912101, 906462769, 141141600, 410332066, 1039081898, 264829189, 905413473, 494365845, 844268769, 825307015, 446030350, 495265225, 484624003, 284032059, 606108639, 414163785, 679820293, 159408475, 376731186, 987141032, 1049813081, 102211116, 896341807, 297191893, 139248770, 609534715, 192720254, 891943031, 344292517, 938868613, 797134685, 242471075, 812006338, 468787252, 921265170, 689632790, 964360616, 579962163, 153192134, 425447091, 344595601, 244193730, 457769820, 376360344, 233554290, 866737030, 569964139, 686899004, 592198811, 79645997, 579254920, 861923395, 120276026, 11561064, 874876835, 490899138, 158652502, 284434116, 366391882, 217268435, 413980438, 107459446, 999334214, 61865772, 941115380, 289994543, 219062347, 244251577, 211894230, 1018714854, 116336985, 262446621, 949132984, 144555011, 344903437, 117252985, 92149529, 770705315, 872676713, 419391224, 141206967, 595756764, 177486223, 484941378, 628242813, 729793274, 1061119307, 29629307, 944503743, 380087523, 21410026, 457012676, 176282251, 906930933, 40202321, 707877240, 1011166921, 104820362, 771971153, 785973303, 186049022, 904427837, 503935705, 659187631, 331333458, 874031910, 1022035801, 1040573821, 971040042, 750362696, 467766257, 635017828, 81160332, 713619099, 622482939, 7739825, 488864266, 683763711, 809007910, 677784656, 649138927, 1063453716, 656288754, 34833648, 928833046, 484357003, 358271316, 434590705, 172822709, 112336955, 654307602, 970676045, 632627404, 766987100, 151877925, 230424378, 813949188, 930618199, 841881992, 886009487, 1029398733, 610008624, 497910358, 867972911, 526336207, 784522639, 223812351, 272177556, 284409694, 1006965258, 1060868237, 354004887, 654220567, 742869121, 73722640, 160494258, 955822703, 423768950, 122007395, 582606937, 143538981, 523158875, 241265102, 306109123, 240113758, 240495484, 58653360, 351296191, 976928720, 554564844, 923256954, 254154577, 506787588, 199518404, 4047416, 637939122, 411866497, 493350884, 782079435, 801961889, 359817992, 193051182, 393747485, 886534282, 422833970, 927864749, 118264130, 624893421, 940092728, 146149353, 996387564, 672960071, 705471770, 621346497, 778123505, 934897585, 987923280, 298630641, 74961773, 897305764, 147730850, 762440718, 964958875, 685881382, 345031517, 1023118996, 68848558, 11153124, 404462100, 710731854, 916379577, 706135663, 37486382, 934659994, 866014983, 700550635, 832060003, 664578477, 956496317, 139152368, 410490476, 932051281, 774240026, 211073320, 817196329, 296820413, 81842726, 167749062, 283538035, 893409119, 451371267, 836690686, 282228835, 470480603, 905305014, 771995819, 695243112, 66904682, 667896441, 603923516, 397249051, 1019995785, 125180349, 937919065, 1000864488, 901357641, 384579864, 162112027, 981911407, 366912808, 900321109, 160825587, 56020251, 603951089, 222497507, 217702477, 652381031, 330726830, 149178442, 236531556, 532835406, 208740276, 631349865, 367244967, 574841247, 502894179, 463582802, 386233525, 306819620, 873891813, 533060276, 155340214, 316519142, 877677168, 511914994, 34441465, 111702679, 72215130, 937241317, 134505865, 473136994, 174718659, 873837555, 93571807, 289934840, 732065109, 95341832, 361379720, 150231553, 98212143, 432895366, 596705731, 894569150, 543884166, 310535050, 458604424, 327066067, 34413126, 964165642, 565406663, 446437452, 93421786, 1005176831, 139315671, 750334287, 6941149, 958131601, 735784416, 910090289, 252309438, 423485709, 523274356, 602440300, 387396692, 280602323, 439339140, 740196519, 627463315, 1062143454, 256756086, 375038157, 458786030, 90929271, 1020734492, 312708701, 896570505, 981682408, 952147158, 1020440958, 205874701, 243393002, 111902154, 881638107, 396119040, 484762186, 537768487, 73255295, 72838112, 1040396997, 803830018, 91525882, 752656672, 472050240, 81068528, 403447742, 76788632, 1066615991, 842491209, 397320376, 591653906, 1026992781, 629340845, 523482293, 731817545, 816433928, 1065988423, 695982544, 593123507, 572706500, 863546604, 872486463, 645734959, 340050148, 263130248, 417738509, 750666038, 605565907, 803580557, 465056171, 364252720, 215498941, 417678281, 968480621, 55042487, 201919941, 577862522, 61441761, 277939783, 291976228, 1009123332, 666763234, 501751218, 385834082, 662189920, 198614658, 441402780, 885962210, 572816843, 297322642, 71321876, 795503745, 511811646, 152244722, 1040714865, 517127958, 300675133, 409331789, 763988890, 1021885821, 451349762, 701391345, 787712883, 644132609, 109902951, 238477886, 294688240, 1029647868, 587127053, 613778323, 238588439, 216610704, 945188215, 313958140, 398736352, 780445713, 878987862, 430801193, 929907272, 237832722, 731658831, 125137315, 774477852, 1072443110, 898148546, 918802414, 144645642, 52846596, 768946839, 780668494, 939709364, 205508936, 1014214857, 693942463, 505197555, 808136475, 1031948379, 326895743, 1055547070, 473004706, 450426564, 872202223, 163485275, 175838382, 802968467, 406029860, 749027341, 339894062, 553721972, 162177363, 857518627, 233291477, 642501114, 932959884, 166314260, 419019973, 230953283, 110708279, 146525000, 257169467, 173971398, 941921227, 46136926, 876242642, 367125388, 717220956, 125306771, 828029383, 94171552, 20328591, 303515622, 101388028, 28002962, 240984874, 648359926, 1065951610, 211099354, 226759713, 150961686, 100070506, 841817256, 88415978, 642542964, 167888776, 828745835, 775002360, 998488240, 63812925, 271613833, 838163351, 356984821, 98853587, 616530339, 56233074, 287302302, 260673125, 956762003, 890689472, 980340823, 502322423, 1013203612, 386100295, 548064523, 656239138, 562413272, 868201236, 940820759, 313177360, 449957887, 947012659, 82186554, 785556336, 376399342, 668664131, 728239371, 362219296, 666588794, 853485336, 485783731, 151109322, 1065539841, 486169675, 744820180, 905646094, 245176054, 48609455, 849737558, 278649909, 748701493, 1042590961, 688111889, 403148048, 393052571, 759150751, 296874303, 393852967, 172361746, 696694790, 232471404, 41720589, 267496222, 663310464, 850559073, 893472086, 1024772033, 98653020, 1067333426, 569285634, 813223290, 85380729, 558858328, 258617680, 954316672, 558261577, 695481938, 330808388, 934752072, 119921293, 928127260, 952477256, 883315282, 519170207, 698219574, 883846900, 735964234, 736095463, 932719390, 313883102, 233929998, 933715563, 600951934, 57953938, 115178528, 672201045, 944514577, 273699299, 908037072, 529256908, 268821947, 615142709, 971988178, 715960485, 667750862, 505934442, 911181923, 713373084, 628929620, 873868142, 538738417, 710395506, 609992541, 489340165, 249132550, 24908214, 802248744, 78864871, 864352662, 745939491, 428066606, 521428668, 504047289, 942497876, 556657715, 263575826, 274864138, 491273697, 749810230, 453005326, 284421820, 966615533, 576828377, 648234862, 626712887, 589402504, 264762694, 103323491, 640558653, 1019006126, 308088331, 903492510, 1059352011, 420273021, 339143073, 715669077, 247181128, 14580451, 1060160714, 140216443, 520500267, 719125559, 594864511, 927989212, 703752138, 180376016, 492788251, 16498439, 925425657, 813236545, 452735728, 317765711, 693875409, 52660490, 1060270573, 399316858, 937033696, 53054897, 805705427, 414031624, 500273484, 917381283, 264047006, 595906689, 764483962, 1070257431, 380376007, 321534223, 106366520, 920242353, 421708529, 539264573, 623754452, 840848508, 514287174, 530309095, 79747545, 293217381, 174643171, 776815444, 887051284, 731424261, 686173467, 207715069, 362175334, 952616093, 106466662, 178436694, 419927204, 1042396351, 628491404, 68394747, 23291651, 608834438, 1031048681, 184269744, 505119737, 42646563, 530987735, 1032559873, 239704844, 905268066, 722119242, 521602195, 180489759, 43728574, 200296364, 182203786, 586248799, 415375764, 230774503, 446770879, 369574070, 564941019, 285874072, 638992562, 209134318, 1008367073, 170946543, 588240606, 225867929, 1044762975, 688787557, 275457188, 342736257, 630129682, 380906536, 815202676, 654032391, 674540706, 689002669, 349070303, 376096676, 844102478, 500738341, 952361307, 147723024, 273150440, 53554008, 701665583, 72286093, 603089776, 902935837, 99682245, 376765143, 175660260, 436135289, 825380635, 941161740, 849120278, 1064953201, 441983534, 113344601, 946190582, 807753599, 415942057, 702213115, 826646145, 290960739, 382224635, 115483956, 552462965, 269025730, 741787488, 331563111, 372234013, 65873757, 574304690, 396185590, 732638751, 737374175, 624399903, 495233150, 823810059, 1003774782, 661228713, 265171299, 958833281, 568487566, 136967847, 157735307, 15924993, 39001601, 140309227, 263635039, 56045566, 545762111, 684117119, 265611357, 775209331, 2564629, 389622723, 286955164, 518528836, 975255765, 872431199, 881660359, 467495495, 672372692, 818266169, 709136446, 267720817, 413734018, 287887204, 980813845, 458487367, 742555727, 157128252, 598374788, 847282837, 992110997, 1030478937, 234662794, 27753872, 638456723, 882224111, 264540954, 498628785, 464617098, 480193104, 282295875, 527759966, 670063428, 202211740, 310065498, 92321687, 224403738, 681488990, 66868554, 982418579, 333805773, 577910290, 242470138, 525323264, 986943639, 468570660, 404783772, 638928798, 754223160, 994812319, 178207008, 933203263, 278026195, 328028225, 937820323, 617068759, 706179267, 326310914, 1062298234, 29822213, 117793695, 598833005, 730317616, 88056861, 532938017, 912675143, 503242570, 330775900, 497856344, 464404314, 81561531, 71428685, 331216036, 456980509, 719939433, 834346380, 1060461140, 615454919, 757689264, 480868710, 246512085, 583623285, 967454629, 415952045, 126252616, 542515146, 638537917, 321318678, 470998495, 81133620, 222229127, 309167426, 497674084, 1026106192, 836547759, 655678229, 828190179, 831052662, 545033526, 14303523, 663553894, 357303274, 11925482, 866886410, 99651271, 242422014, 342979938, 894037133, 370553474, 849530492, 30102821, 986283711, 253146446, 548538883, 422640132, 215824452, 765541223, 143651022, 421374936, 449812091, 396256785, 507399974, 311172148, 271647482, 621578270, 181718552, 669598416, 513801695, 944984352, 639431702, 588912574, 50753649, 746927));
        List<Integer> zetasInvertedInts = new ArrayList<>(Arrays.asList(970136676, 531278430, 8612253, 1038152165, 131951051, 583204174, 674025485, 328986017, 1045117713, 196100517, 327254350, 214865857, 145462206, 91405032, 181277513, 393297422, 1051704452, 972030401, 371939559, 627052111, 449820565, 404988550, 264017316, 458895838, 510023346, 961658272, 29985310, 709044286, 638655201, 406099526, 1063497884, 1002472741, 378331480, 780991104, 562160550, 995241993, 210598478, 794965997, 1037020984, 604365662, 701563406, 882253415, 886177146, 717915593, 16429582, 360115636, 819029345, 954534387, 520317176, 710501877, 730338555, 1041632549, 885506878, 284214339, 426133215, 545356560, 1064210094, 508467097, 818723337, 662862592, 1007990925, 489070132, 980465242, 789447622, 588855678, 578214456, 627449331, 248172666, 229210912, 579113836, 168066208, 808650492, 34397783, 663147615, 932338081, 167016912, 642567580, 423652185, 21458318, 652818108, 788811799, 397343912, 257834309, 62157670, 763291923, 998591224, 973471846, 845500443, 507777504, 85568823, 143740275, 3582480, 429209758, 153222134, 728863862, 109104351, 38214889, 303996489, 739721074, 16568523, 71808737, 145991318, 1048164287, 35776908, 509792487, 829912157, 16104025, 754269214, 188775514, 730337585, 1027352968, 946453318, 671916229, 108799165, 32918739, 280562447, 816968520, 583186511, 241985870, 940397753, 396597888, 481276821, 300894342, 609363992, 823443071, 225910050, 538847756, 463471057, 44080948, 187470194, 231597689, 142861482, 259530493, 843055303, 921601756, 306492581, 440852277, 102803636, 419172079, 961142726, 900656972, 638888976, 715208365, 589122678, 144646635, 1038646033, 417190927, 10025965, 424340754, 395695025, 264471771, 389715970, 584615415, 1065739856, 450996742, 359860582, 992319349, 438461853, 605713424, 323116985, 102439639, 32905860, 51443880, 199447771, 742146223, 414292050, 569543976, 169051844, 887430659, 287506378, 301508528, 968659319, 62312760, 365602441, 1033277360, 166548748, 897197430, 616467005, 1052069655, 693392158, 128975938, 1043850374, 12360374, 343686407, 445236868, 588538303, 895993458, 477722917, 932272714, 654088457, 200802968, 302774366, 981330152, 956226696, 728576244, 928924670, 124346697, 811033060, 957142696, 54764827, 861585451, 829228104, 854417334, 783485138, 132364301, 1011613909, 74145467, 966020235, 659499243, 856211246, 707087799, 789045565, 914827179, 582580543, 198602846, 1061918617, 953203655, 211556286, 494224761, 993833684, 481280870, 386580677, 503515542, 206742651, 839925391, 697119337, 615709861, 829285951, 728884080, 648032590, 920287547, 493517518, 109119065, 383846891, 152214511, 604692429, 261473343, 831008606, 276344996, 134611068, 729187164, 181536650, 880759427, 463944966, 934230911, 776287788, 177137874, 971268565, 23666600, 86338649, 696748495, 914071206, 393659388, 659315896, 467371042, 309490791, 664147892, 772804548, 556351723, 32764816, 921234959, 561668035, 277975936, 1002157805, 776157039, 500662838, 187517471, 632076901, 874865023, 411289761, 687645599, 571728463, 406716447, 64356349, 781503453, 795539898, 1012037920, 495617159, 871559740, 1018437194, 104999060, 655801400, 857980740, 709226961, 608423510, 269899124, 467913774, 322813643, 655741172, 810349433, 733429533, 427744722, 200993218, 209933077, 500773181, 480356174, 377497137, 7491258, 257045753, 341662136, 549997388, 444138836, 46486900, 481825775, 676159305, 230988472, 6863690, 996691049, 670031939, 992411153, 601429441, 320823009, 981953799, 269649663, 33082684, 1000641569, 1000224386, 535711194, 588717495, 677360641, 191841574, 961577527, 830086679, 867604980, 53038723, 121332523, 91797273, 176909176, 760770980, 52745189, 982550410, 614693651, 698441524, 816723595, 11336227, 446016366, 333283162, 634140541, 792877358, 686082989, 471039381, 550205325, 649993972, 821170243, 163389392, 337695265, 115348080, 1066538532, 323145394, 934164010, 68302850, 980057895, 627042229, 508073018, 109314039, 1039066555, 746413614, 614875257, 762944631, 529595515, 178910531, 476773950, 640584315, 975267538, 923248128, 712099961, 978137849, 341414572, 783544841, 979907874, 199642126, 898761022, 600342687, 938973816, 136238364, 1001264551, 961777002, 1039038216, 561564687, 195802513, 756960539, 918139467, 540419405, 199587868, 766660061, 687246156, 609896879, 570585502, 498638434, 706234714, 442129816, 864739405, 540644275, 836948125, 924301239, 742752851, 421098650, 855777204, 850982174, 469528592, 1017459430, 912654094, 173158572, 706566873, 91568274, 911367654, 688899817, 172122040, 72615193, 135560616, 948299332, 53483896, 676230630, 469556165, 405583240, 1006574999, 378236569, 301483862, 168174667, 602999078, 791250846, 236788995, 622108414, 180070562, 789941646, 905730619, 991636955, 776659268, 256283352, 862406361, 299239655, 141428400, 662989205, 934327313, 116983364, 408901204, 241419678, 372929046, 207464698, 138819687, 1035993299, 367344018, 157100104, 362747827, 669017581, 1062326557, 1004631123, 50360685, 728448164, 387598299, 108520806, 311038963, 925748831, 176173917, 998517908, 774849040, 85556401, 138582096, 295356176, 452133184, 368007911, 400519610, 77092117, 927330328, 133386953, 448586260, 955215551, 145614932, 650645711, 186945399, 679732196, 880428499, 713661689, 271517792, 291400246, 580128797, 661613184, 435540559, 1069432265, 873961277, 566692093, 819325104, 150222727, 518914837, 96550961, 722183490, 1014826321, 832984197, 833365923, 767370558, 832214579, 550320806, 929940700, 490872744, 951472286, 649710731, 117656978, 912985423, 999757041, 330610560, 419259114, 719474794, 12611444, 66514423, 789069987, 801302125, 849667330, 288957042, 547143474, 205506770, 575569323, 1072732754, 1022726032, 484567107, 434047979, 128495329, 559677986, 403881265, 891761129, 451901411, 801832199, 762307533, 566079707, 677222896, 623667590, 652104745, 929828659, 307938458, 857655229, 650839549, 524940798, 820333235, 87195970, 1043376860, 223949189, 702926207, 179442548, 730499743, 831057667, 973828410, 206593271, 1061554199, 716176407, 409925787, 1059176158, 528446155, 242427019, 245289502, 417801452, 236931922, 47373489, 575805597, 764312255, 851250554, 992346061, 602481186, 752161003, 434941764, 530964535, 947227065, 657527636, 106025052, 489856396, 826967596, 592610971, 315790417, 458024762, 13018541, 239133301, 353540248, 616499172, 742263645, 1002050996, 991918150, 609075367, 575623337, 742703781, 570237111, 160804538, 540541664, 985422820, 343162065, 474646676, 955685986, 1043657468, 11181447, 747168767, 367300414, 456410922, 135659358, 745451456, 795453486, 140276418, 895272673, 78667362, 319256521, 434550883, 668695909, 604909021, 86536042, 548156417, 831009543, 495569391, 739673908, 91061102, 1006611127, 391990691, 849075943, 981157994, 763414183, 871267941, 403416253, 545719715, 791183806, 593286577, 608862583, 574850896, 808938727, 191255570, 435022958, 1045725809, 838816887, 43000744, 81368684, 226196844, 475104893, 916351429, 330923954, 614992314, 92665836, 785592477, 659745663, 805758864, 364343235, 255213512, 401106989, 605984186, 191819322, 201048482, 98223916, 554950845, 786524517, 683856958, 1070915052, 298270350, 807868324, 389362562, 527717570, 1017434115, 809844642, 933170454, 1034478080, 1057554688, 915744374, 936511834, 504992115, 114646400, 808308382, 412250968, 69704899, 249669622, 578246531, 449079778, 336105506, 340840930, 677294091, 499174991, 1007605924, 701245668, 741916570, 331692193, 804453951, 521016716, 957995725, 691255046, 782518942, 246833536, 371266566, 657537624, 265726082, 127289099, 960135080, 631496147, 8526480, 224359403, 132317941, 248099046, 637344392, 897819421, 696714538, 973797436, 170543844, 470389905, 1001193588, 371814098, 1019925673, 800329241, 925756657, 121118374, 572741340, 229377203, 697383005, 724409378, 384477012, 398938975, 419447290, 258277005, 692573145, 443349999, 730743424, 798022493, 384692124, 28716706, 847611752, 485239075, 902533138, 65112608, 864345363, 434487119, 787605609, 508538662, 703905611, 626708802, 842705178, 658103917, 487230882, 891275895, 873183317, 1029751107, 892989922, 551877486, 351360439, 168211615, 833774837, 40919808, 542491946, 1030833118, 568359944, 889209937, 42431000, 464645243, 1050188030, 1005084934, 444988277, 31083330, 653552477, 895042987, 967013019, 120863588, 711304347, 865764612, 387306214, 342055420, 186428397, 296664237, 898836510, 780262300, 993732136, 543170586, 559192507, 232631173, 449725229, 534215108, 651771152, 153237328, 967113161, 751945458, 693103674, 3222250, 308995719, 477572992, 809432675, 156098398, 573206197, 659448057, 267774254, 1020424784, 136445985, 674162823, 13209108, 1020819191, 379604272, 755713970, 620743953, 260243136, 148054024, 1056981242, 580691430, 893103665, 369727543, 145490469, 478615170, 354354122, 552979414, 933263238, 13318967, 1058899230, 826298553, 357810604, 734336608, 653206660, 14127670, 169987171, 765391350, 54473555, 432921028, 970156190, 808716987, 484077177, 446766794, 425244819, 496651304, 106864148, 789057861, 620474355, 323669451, 582205984, 798615543, 809903855, 516821966, 130981805, 569432392, 552051013, 645413075, 327540190, 209127019, 994614810, 271230937, 1048571467, 824347131, 584139516, 463487140, 363084175, 534741264, 199611539, 444550061, 360106597, 162297758, 567545239, 405728819, 357519196, 101491503, 458336972, 804657734, 544222773, 165442609, 799780382, 128965104, 401278636, 958301153, 1015525743, 472527747, 139764118, 839549683, 759596579, 140760291, 337384218, 337515447, 189632781, 375260107, 554309474, 190164399, 121002425, 145352421, 953558388, 138727609, 742671293, 377997743, 515218104, 119163009, 814862001, 514621353, 988098952, 260256391, 504194047, 6146255, 974826661, 48707648, 180007595, 222920608, 410169217, 805983459, 1031759092, 841008277, 376784891, 901117935, 679626714, 776605378, 314328930, 680427110, 670331633, 385367792, 30888720, 324778188, 794829772, 223742123, 1024870226, 828303627, 167833587, 328659501, 587310006, 7939840, 922370359, 587695950, 219994345, 406890887, 711260385, 345240310, 404815550, 697080339, 287923345, 991293127, 126467022, 623521794, 760302321, 132658922, 205278445, 511066409, 417240543, 525415158, 687379386, 60276069, 571157258, 93138858, 182790209, 116717678, 812806556, 786177379, 1017246607, 456949342, 974626094, 716494860, 235316330, 801865848, 1009666756, 74991441, 298477321, 244733846, 905590905, 430936717, 985063703, 231662425, 973409175, 922517995, 846719968, 862380327, 7528071, 425119755, 832494807, 1045476719, 972091653, 769964059, 1053151090, 979308129, 245450298, 948172910, 356258725, 706354293, 197237039, 1027342755, 131558454, 899508283, 816310214, 926954681, 962771402, 842526398, 654459708, 907165421, 140519797, 430978567, 840188204, 215961054, 911302318, 519757709, 733585619, 324452340, 667449821, 270511214, 897641299, 909994406, 201277458, 623053117, 600474975, 17932611, 746583938, 41531302, 265343206, 568282126, 379537218, 59264824, 867970745, 133770317, 292811187, 304532842, 1020633085, 928834039, 154677267, 175331135, 1036571, 299001829, 948342366, 341820850, 835646959, 143572409, 642678488, 194491819, 293033968, 674743329, 759521541, 128291466, 856868977, 834891242, 459701358, 486352628, 43831813, 778791441, 835001795, 963576730, 429347072, 285766798, 372088336, 622129919, 51593860));
        zetas.addAll(zetasInts.stream().map(BigInteger::valueOf).toList());
        zetasInverted.addAll(zetasInvertedInts.stream().map(BigInteger::valueOf).toList());
    }
}
